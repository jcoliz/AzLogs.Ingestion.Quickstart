{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "inputColumns": {
            "value": [
                {
                    "name": "TimeOnClient",
                    "type": "datetime"
                },
                {
                    "name": "Id",
                    "type": "string"
                },
                {
                    "name": "Message",
                    "type": "string"
                },
                {
                    "name": "Properties",
                    "type": "dynamic"
                },
                {
                    "name": "Category",
                    "type": "string"
                },
                {
                    "name": "Severity",
                    "type": "string"
                },
                {
                    "name": "Campaign",
                    "type": "string"
                },
                {
                    "name": "Decoy",
                    "type": "dynamic"
                },
                {
                    "name": "DeviceEventClass",
                    "type": "string"
                },
                {
                    "name": "SourceAddress",
                    "type": "string"
                },
                {
                    "name": "SourceHostName",
                    "type": "string"
                },
                {
                    "name": "SourceHostId",
                    "type": "string"
                },
                {
                    "name": "DestinationAddress",
                    "type": "string"
                },
                {
                    "name": "DestinationPort",
                    "type": "string"
                },
                {
                    "name": "MitreTacticName",
                    "type": "string"
                },
                {
                    "name": "MitreTechniqueName",
                    "type": "string"
                },
                {
                    "name": "FileHash",
                    "type": "string"
                },
                {
                    "name": "User",
                    "type": "string"
                }
            ]
        },
        "transformKql": {
            "value":  "source\n| extend TimeGenerated = now()\n"
        },
        "tableSchema": {
            "value": {
                "name": "InfiniteMirrorDetectionEvents_CL",
                "description": "Deception events detected by the Infinite Mirror solution",
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "TimeOnClient",
                        "type": "datetime"
                    },
                    {
                        "name": "Id",
                        "type": "string"
                    },
                    {
                        "name": "Message",
                        "type": "string"
                    },
                    {
                        "name": "Properties",
                        "type": "dynamic"
                    },
                    {
                        "name": "Category",
                        "type": "string"
                    },
                    {
                        "name": "Severity",
                        "type": "string"
                    },
                    {
                        "name": "Campaign",
                        "type": "string"
                    },
                    {
                        "name": "Decoy",
                        "type": "dynamic"
                    },
                    {
                        "name": "DeviceEventClass",
                        "type": "string"
                    },
                    {
                        "name": "SourceAddress",
                        "type": "string"
                    },
                    {
                        "name": "SourceHostName",
                        "type": "string"
                    },
                    {
                        "name": "SourceHostId",
                        "type": "string"
                    },
                    {
                        "name": "DestinationAddress",
                        "type": "string"
                    },
                    {
                        "name": "DestinationPort",
                        "type": "string"
                    },
                    {
                        "name": "MitreTacticName",
                        "type": "string"
                    },
                    {
                        "name": "MitreTechniqueName",
                        "type": "string"
                    },
                    {
                        "name": "FileHash",
                        "type": "string"
                    },
                    {
                        "name": "User",
                        "type": "string"
                    }
                ]
            }
        }
    }
}
